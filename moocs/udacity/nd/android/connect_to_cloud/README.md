# [Connect to Cloud](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762)

### **Goals**:
1. Connect to web service (open weather API)
2. Understand Logging & LogCat
3. UI (main) Thread limitations
4. AsyncTask (for background operations)
5. Create and update Menu Options


### **Code Steps (GitHub) **
1. [Network Call](https://github.com/udacity/Sunshine/tree/2.01-network-call)
2. [Off Main Thread](https://github.com/udacity/Sunshine/tree/2.02-off-main-thread)
3. [Add Refresh Menu Item](https://github.com/udacity/Sunshine/tree/2.03-add-refresh-menu-item-xml)
4. [Inflate Menu Layout](https://github.com/udacity/Sunshine/tree/2.04-inflate-menu-layout)
5. [Trigger Refresh](https://github.com/udacity/Sunshine/tree/2.05-trigger-refresh)
6. [Internet Permission](https://github.com/udacity/Sunshine/tree/2.06-internet-permission)
7. [URL Binding](https://github.com/udacity/Sunshine/tree/2.07-url-building)
8. [JSON Parsing](https://github.com/udacity/Sunshine/tree/2.08-json-parsing)
9. [Update Adapter](https://github.com/udacity/Sunshine/tree/2.09-update-adapter)

### **SubChapters**:
1. [Introduction](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1630778606)
2. [Review data provided by Open Weather Map](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1530568547)
3. [Try out web queries](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568548/m-1530568549) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568548/m-1484928594))
4. [Find the query we want](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568550/m-1530568551) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568550/m-1484928596)) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568550/m-1530568552))
5. [Http Request for weather data](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568553/m-1530568554) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568553/m-1484928598))
6. [Http Requests](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1530568555)
7. [LogCat](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568556/m-1530568557) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568556/m-1484928600))
8. [Logging on Android](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1530568558)
9. [Network Call](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568559/m-1530568560) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568559/m-1484928602)) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568559/m-1530568561))
10. [Main Thread vs. Background Thread](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568562/m-1530568563) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568562/m-1484928604)) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568562/m-1530568564))
11. [Which Thread for AsyncTask](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568565/m-1530568566) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568565/m-1484928606)) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568565/m-1530568567))
12. [Move to AsyncTask](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568568/m-1530568569) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568568/m-1484928608)) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568568/m-1530568570))
13. [Add Refresh Button](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1530568571)
14. [Why AsyncTask is not Optimal]( https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778607/m-1630778608) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778607/m-1612228631)) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778607/m-1630778609))
15. [Better Ways to Sync](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1630778610)
16. [Menu Buttons](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1630778611)
17. [Refresh Button](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778612/m-1630778613) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778612/m-1630778614)) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778612/m-1630778615))
18. [Refresh Button Behavior](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778616/m-1630778617) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778616/m-1630778618)) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778616/m-1630778619))
19. [Execute Async Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778620/m-1630778621) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778620/m-1630778622)) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778620/m-1630778623)
20. [Permissions](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1630778624)
21. [Permissions in the Manifest](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778625/m-1630778626) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778625/m-1630778628))
22. [Adding Internet Permissions](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778629/m-1630778630) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778629/m-1630778632))
23. [Postal Code Param](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778633/m-1630778634) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778633/m-1630778636))
24. [Identify Desired JSON Attributes](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778637/m-1630778638) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778637/m-1630778639)) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778637/m-1630778640))
25. [Parse out the Max Temp](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778641/m-1630778642) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778641/m-1226659448)) [(Solution)](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778641/m-1630778643)
26. [JSON Parsing](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1630778644/m-1630778645)
27. [Update the Adapter](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1565719311/m-1565719312) ([Task](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1565719311/m-1565719313)) ([Solution](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1565719311/m-1565719314))
28. [Source Code for ArrayAdapter](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1565719315) ([Source](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/widget/ArrayAdapter.java))
29. [Take a ScreenShot](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1639448636)
30. [Done!](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1639448637)
31. [Lesson 2 Recap](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1630778648)
32. [Storytime: Android Consumer Platform](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-1562269355)
33. [**Review Material for Lesson 2**](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/m-3637468791)


### **Lesson Resources**
1. [Open Weather Map](http://openweathermap.org/API) ([API examples](http://openweathermap.org/current) and [weather codes](http://bugs.openweathermap.org/projects/api/wiki/Weather_Condition_Codes), [n-day forecast](http://openweathermap.org/forecast)).
2. [Networking code snippet (gist)](https://gist.github.com/anonymous/1c04bf2423579e9d2dcd)
3. [Android Developers: Connecting to the Network](http://developer.android.com/training/basics/network-ops/connecting.html)
4. [Android's HTTP Clients (And Dev. Blog, 2011)](http://android-developers.blogspot.com/2011/09/androids-http-clients.html)
5. [Logcat](https://www.udacity.com/course/viewer#!/c-ud853/l-1469948762/e-1530568556/m-1530568557)
6. [Reading & Writing Logs](http://developer.android.com/tools/debugging/debugging-log.html)
7. [Processes & Threads](http://developer.android.com/guide/components/processes-and-threads.html)
8. [AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)
9. [Scheduling inexact Alarms](https://developer.android.com/training/scheduling/alarms.html)
10. [Google Cloud Messaging (GCM)](https://developer.android.com/google/gcm/index.html)
11. [Sync Adapter for Transferring Data](http://developer.android.com/training/sync-adapters/index.html)
12. [Menu Training Guide](http://developer.android.com/guide/topics/ui/menus.html)
13. [Menu Resource](http://developer.android.com/guide/topics/resources/menu-resource.html) ([and other Resources](http://developer.android.com/guide/topics/resources/index.html))
14. [Fragment Lifecycle](http://developer.android.com/reference/android/app/Fragment.html)
15. [UriBuilder](http://developer.android.com/reference/android/net/Uri.Builder.html)
16. [JSON Formatter and Validator](http://jsonformatter.curiousconcept.com/)
17. [JSON Object in Android](http://developer.android.com/reference/org/json/JSONObject.html) ([Gist](https://gist.github.com/anonymous/9d251540d992efd5ffab))


### **Notes**
1. **For networking**, favor *HttpUrlConnection* over *HttpClient*. Both support HTTPS, streaming and connection pooling - but the former is more general purpose, lightweight and optimized for Android apps.

2. **Logging & LogCat**  Use "*adb logcat*" (or the DDMS LogCat view) to see log messages from your app. To insert these messages in your code, use the Log class.

3. **Refactoring PlaceholderFragment**: Note that the layout resource file also has a reference to this fragment name. If the refactoring is not done cleanly, you will see error messages citing PlaceholderFragment as still being referenced.

4. **AsyncTask Limitations**. Recollect that AsyncTask is tied to a UI component (here, Activity) which means that it will be terminated if the host activity is stopped or terminated for any reason (e.g., change in orientation causes new UI to be loaded). This in turn will cause the data transfer (on the AsyncTask) to terminate prematurely. In general, use AsyncTask only for short-term background tasks that should not block UI thread. For any recurring or long-term task explore other background transfer options including Services, Inexact alarms, GCM (cloud messaging) and SyncAdapter.

5. **Menu Options** are declared in XML (under resources) for fragments or activities. *Action Buttons* are the options that are clearly visible on the Action Bar. Lower priority options fall into the *Overflow* area (drop down from 3 dots), with the least important at the bottom.
6. **Menu Options Setup**. A fragment can add menu options to the Menu at the container activity - it signals that it has menu options to add with *Fragment.setHasOptionsMenu(true)*, and implements the *onOptionsItemSelected()* method to then handle interactions on those options.


### **Issues (Q&A)**

*We'll use this section to document and answer popular questions from study participants about this lesson.*

* **AsyncTask** Explain AsyncTask operation with the image below ([from this article](http://www.lucadentella.it/en/2014/05/04/android-e-bluetooth-5/)) . In addition, look at the [Processes and Threads](http://developer.android.com/guide/components/processes-and-threads.html) and [AsyncTask API](http://developer.android.com/reference/android/os/AsyncTask.html) sections on Android Developers.
![](http://www.lucadentella.it/blog/wp-content/uploads/2014/05/asynctask.jpg)

* **Permissions** Walkthrough the [Permissions Guide](http://developer.android.com/guide/topics/security/permissions.html) and talk about [Manifest Permissions](http://developer.android.com/reference/android/Manifest.permission.html), [Permission Groups](http://developer.android.com/reference/android/Manifest.permission_group.html)
    * Talk about [the difference between 'permission' and 'uses-permission'](http://stackoverflow.com/questions/14450839/uses-permission-vs-permission-for-android-permissions-in-the-manifest-xml-file) declarations in Manifest. (Hint: *permission*=custom permissions I create and that others need to get this to use my app's features, *uses-permission*=I need to get this to do my job).
    * Use these commands to see permissions on your system
```
adb shell pm list permissions
```
    * Look [at this example](http://developer.android.com/guide/topics/manifest/manifest-intro.html#perms) to get a sense of how this works. Here the app declares its custom permission ("permission"), then declares that it uses that permission itself ("uses-permission") requiring the user to agree to that usage. The reason it does so is that this app's components itself (here the 'activity') indicate that they are protected by that permission, requiring it to be given before that component can be used by other components of this app itself.
```
<manifest . . . >
    <permission android:name="com.example.project.DEBIT_ACCT" . . . />
    <uses-permission android:name="com.example.project.DEBIT_ACCT" />
    . . .
    <application . . .>
        <activity android:name="com.example.project.FreneticActivity"
                  android:permission="com.example.project.DEBIT_ACCT"
                  . . . >
            . . .
        </activity>
    </application>
</manifest>
```

*


